coord_flip()
p1
summary_sa <- summary_sa %>% mutate(percentage = suicide_total/population_total)
summary_sa <- summary_sa %>% mutate(percentage = suicide_total/population_total*100)
p1 <- ggplot(summary_sa)+
geom_col(
mapping = aes(x= year, y = percentage)
)+
coord_flip()
p1
p1 <- ggplot(summary_sa,aes(x= year, y = percentage))+
geom_point()+
geom_line()
p1
p1 <- ggplot(summary_sa,aes(x= year, y = percentage))+
geom_point()+
geom_line()+
labs(
title = "Suicide Rates Cross Years"
)
ggsave(file = "suicide_cross_year.pdf", path = "charts/")
p1 <- ggplot(summary_sa,aes(x= year, y = percentage))+
geom_point()+
geom_line()+
labs(
title = "Suicide Rates Cross Years"
)
ggsave(file = "suicide_cross_year.pdf", path = "chart/")
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv")
View(data)
data$state = substr(data$state,1, nchar(data$state)-5)
data$State = substr(data$State,1, nchar(data$State)-5)
data$State = substr(data$State,1, 5)
data$State = substr(data$State,1, 10)
data$State = substr(data$State,1, 10)
data <- read.csv("data/intentional_self_harm_data.csv")
data$state = substr(data$state,1, nchar(data$state)-5)
data[1,1]
data$state <- substr(data$state,1, nchar(data$state)-5)
data$state <- lapply(data$State, substr(1,nchar(data$state)-5))
data$state <- lapply(data$State, substr((data$Stat,1,nchar(data$state)-5))
data$state <- lapply(data$State, substr(1,nchar-5))
data$state <- lapply(data$State, substr(1,nchar))
data$state <- lapply(data$State, substr(1,nchar())
data$state <- lapply(data$State, substr(1,nchar()-5)
data$state <- lapply(data$State, substr(1,nchar())
data$state <- lapply(data$State, substr(1,nchar()))
data$state <- lapply(data$State, substr(1,nchar()))
data$state <- lapply(data$State, substr(1,nchar))
substr(data[,'State'], 1, nchar(data[,'State'])-3)
substr(data[,'State'], 1, nchar(data[,'State'])-3)
substr(data[,'State'], 1, nchar(data[,'State'])-3)
data$state <- substr(data$state,1, nchar(data$state)-5)
data$state <- substr(data$state,1, nchar(data$state)-5)
substr(data[,'State'], 1, nchar(data[,'State'])-3)
data$State[data$State == 'Alabama01'] <- 'Alabama'
data$State[data$State = 'Alabama01'] <- 'Alabama'
data$State[data$State == 'Alabama01'] <- 'Alabama'
data$state <- substr(data$state,1, nchar(data$state))
data$state <- substr(data$state,1, nchar())
data$state <- substr(data$state,1, nchar(data$state)-5)
substr(data[,'State'], 1, nchar(data[,'State'])-3)
substr(data[,'State'], 1, nchar(data[,'State'])-3)
substr(data[,'State'], 1, nchar(data[,'State'])-3)
data$state <- substr(data$state,1, as.characters(nchar(data$state))-5)
data$state <- substr(data$state,1, as.characters(nchar(data$state))-5)
substr(data[,'State'], 1, nchar(data[,'State'])-3)
data$state <- substr(data$state,1, as.characters(nchar(data$state))-5)
data$state <- substr(data$state,1, nchar(as.character(data$state))-5)
data$state <- substr(data$state,1, nchar(as.character(data$state))-5)
substr(data[,'State'], 1, nchar(data[,'State'])-3)
data$state <- substr(data$state,1, nchar(as.character(data$State))-5)
data$state <- substr(data$state,1, nchar(as.character(data$State))-5)
data$state <- substr(data$state,1, nchar(as.character(data$State))-5)
data$State <- as.character(data$State)
data$state <- substr(data$state,1, nchar(as.character(data$State))-5)
data$State <- as.character(data$State)
data$state <- substr(data$state,1, nchar(data$State)-5)
state_name <- data$State
state_name <- data$State
list_n <- nchar(state_name)
substr(df[,'Names'], 1, nchar(df[,'Names'])-3)
list_n
list_n <- substr(state_name,1,nchar(state_name)-5)
list_n
state <- data$State
state_name <- substr(state,1,nchar(state)-5)
data$state <- state_name
View(data)
state_name <- substr(state,1,nchar(state)-5)
data$state <- state_name
state_name
data$state = state_name
View(data)
data$State<- substr(state,1,nchar(state)-5)
data$State <- as.character(data$State)
state <- data$State
data$State<- substr(state,1,nchar(state)-5)
state <- data$State
data$State<- substr(state,1,nchar(state)-5)
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv")
state <- data$State
data$State<- substr(state,1,nchar(state)-5)
rm(list=ls())
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv")
state <- data$State
state.name<- substr(state,1,nchar(state)-5)
data <- read.csv("data/intentional_self_harm_data.csv")
state <- data$State
state.name<- substr(state,1,nchar(state)-5)
state_name<- substr(state,1,nchar(state)-5)
state <- data$State
state
state_name = substr(state,1,nchar(state)-5)
as.character(data$State)
state <- data$State
state_name<- substr(state,1,nchar(state)-5)
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
data$states <- nchar(as.character(data$State))
data$states <- substr(data$State,nchar(as.character(data$State))-5)
data$states <- as.numeric(data$states)
data$new <-substr(data$State, 1, data$states -5)
data <- read.csv("data/intentional_self_harm_data.csv")
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
data$state <-substr(data$State, 1, data$state_length -5)
df <- data %>% select(8,2,3,4,5)
View(df)
df <- df %>% mutate(death_rate = Death/Population)
df <- df %>% mutate(death_rate = Death/Population)
df <- df %>% mutate(death_rate = as.numeric(Death)/as.numeric(Population))
df <- data %>% select(8,2,3,4,5)
df <- df %>% mutate(rate = Death/Population)
df <- df %>% mutate(rate = as.numeric(Death)/as.numeric(Population))
df <- df %>% mutate(rate = Death/Population, na.rm = T)
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv")
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
data$state <-substr(data$State, 1, data$state_length -5)
df <- data %>% select(8,2,3,4,5)
df <- df %>% mutate(rate = as.numeric(Death)/as.numeric(Population))
View(df)
df$Death
as.numeric(df$Death)
as.numeric(df$Population)
df <- df %>% mutate(rate = Death/Population)
as.numeric(df$Death)
as.numeric(df$Population)
df <- df %>% mutate(rate = Death/Population)
df$Death = as.numeric(df$Death)
df$Population = as.numeric(df$Population)
df <- df %>% mutate(rate = Death/Population)
View(data)
data$Crude.Rate.per.100.000 = as.numeric(data$Crude.Rate.per.100.000)
data$Year <- as.numeric(data$Year)
data <- data %>%mutate (sb= Death/Population)
data$Death = as.numeric(data$Death)
rm(list=ls())
df$Death = as.character(as.numeric(df$Death))
df$Death = as.numeric(as.character(df$Population))
df$Death <- as.numeric(as.character(df$Population))
df$Death <- as.numeric(as.character(df$Death))
as.numeric(levels(df$Death))[df$Death]
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
data <- read.csv("data/intentional_self_harm_data.csv", stringsAsFactors = F)
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
data$state <-substr(data$State, 1, data$state_length -5)
df <- data %>% select(8,2,3,4,5)
df$Death <- as.numeric(as.character(df$Death))
df <- df %>% mutate(rate = Death/Population)
df$Population = as.numeric(df$Population)
df <- df %>% mutate(rate = Death/Population)
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
data <- read.csv("data/intentional_self_harm_data.csv", stringsAsFactors = FALSE)
data <- read.csv("data/intentional_self_harm_data.csv", stringsAsFactors = FALSE)
df$Population = as.numeric(df$Population)
df <- df %>% mutate(rate = Death/Population)
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
data <- read.csv("data/intentional_self_harm_data.csv")
data <- read.csv("data/intentional_self_harm_data.csv")
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
data$state <-substr(data$State, 1, data$state_length -5)
df$Death <- as.numeric(df$Death)
df$Death <- as.numeric(df$Death)
df$Population = as.numeric(df$Population)
df$Population <- as.numeric(df$Population)
df$Population <- as.numeric(df$Population)
df <- df %>% mutate(rate = Death/Population, na.rm = T)
source('~/Desktop/HealthReport-TeamBug/Overall-Claire/analysis.R')
View(df)
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv", stringsAsFactors = FALSE)
View(data)
data$Death <- as.numeric(data$Death)
data$Population <- as.numeric(data$Population)
data$Population <- suppressWarnings(as.numeric(data$Population))
f_df <- read.csv("data/df.csv", stringsAsFactors = FALSE)
f_df <- read.csv("data/df_f.csv", stringsAsFactors = FALSE)
View(f_df)
f_df <- f_df %>% mutate(math = death/population)
f_df$death <- as.numeric(f_df$death)
data <- read.csv2("data/intentional_self_harm_data.csv", stringsAsFactors = FALSE)
data$Death <- as.numeric(data$Death)
data$Population <- as.numeric(data$Population)
as.character(data$State)
View(data)
data <- read.csv("data/intentional_self_harm_data.csv", stringsAsFactors = FALSE)
data$Death <- as.numeric(data$Death)
data$Population <- as.numeric(data$Population)
data$Death <- as.numeric(data$Death)
data$Population <- as.numeric(data$Population)
data <- read.csv("data/intentional_self_harm_data.csv", stringsAsFactors = FALSE)
data$Death <- as.numeric(data$Death)
data <- read.csv("data/intentional_self_harm_data.csv", stringsAsFactors = FALSE)
is.numeric(data$Death)
is.numeric(data$Population)
is.factor(data$Death)
View(data)
typeof(data$Death)
data$Death <- as.numeric(as.character(data$Death))
data <- read.csv("data/intentional_self_harm_data.csv", stringsAsFactors = FALSE)
data$Death <- as.numeric(as.character(data$Death))
data <- read.csv("data/intentional_self_harm_data.csv", stringsAsFactors = FALSE)
data$Death <- as.numeric(as.factor(data$Death))
data <- read.csv("data/intentional_self_harm_data.csv", stringsAsFactors = FALSE)
View(data)
data$Death <- as.numeric(as.factor(data$Death))
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(as.factor(data$Death))
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(data$Death)
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(as.character(data$Death))
data$Population <- as.numeric(as.character(data$Population))
data <- read.csv("data/intentional_self_harm_data.csv")
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(as.character(data$Death))
data$Population <- as.numeric(as.character(data$Population))
data <- data %>% mutate(rate = Death/Population)
data <- data %>% mutate(rate = Death/Population*100000)
data <- data %>% mutate(rate = round(Death/Population*100000,2))
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(as.character(data$Death))
data$Population <- as.numeric(as.character(data$Population))
data <- data %>% mutate(rate = round(Death/Population*100000,2))
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
data$state <-substr(data$State, 1, data$state_length -5)
df <- data %>% select(8,2,3,4,5)
View(df)
df <- data %>% select(8,2,3,4,5,7)
df <- data %>% select(9,2,3,4,5,7)
state_one <- "Washington"
state_two <- "New York"
chosen_states <- df %>% filter(state == state_one, state == state_two)
View(chosen_states)
chosen_states <- df %>% filter(state == state_one| state == state_two)
View(chosen_states)
usa_data <- data %>% group_by(year, gender) %>% summarize(Death = sum(Death), Population = sum(Population), rate = sum(Death)/sum(Population) )
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), rate = sum(Death)/sum(Population) )
View(usa_data)
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), round(rate = sum(Death)/sum(Population)*100000,2 )
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), round(rate = sum(Death)/sum(Population)*100000,2))
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), round(rate = sum(Death)/sum(Population)*100000,2))
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), Year = Year)
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), State = "United States")
usa_data <- usa_data %>% mutate(rate = round(Death/Population*100000,2))
usa_data <- usa_data %>% mutate(rate = round(Death/Population*100000,2)) %>% select(6,2,1,3,4,7)
usa_data <- usa_data %>% mutate(rate = round(Death/Population*100000,2)) %>% select(6,2,1,3,4,7)
usa_data <- usa_data %>% select(5,2,1,3,4,6)
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(as.character(data$Death))
data$Population <- as.numeric(as.character(data$Population))
data <- data %>% mutate(rate = round(Death/Population*100000,2))
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
usa_data <- usa_data %>% mutate(Rate = round(Death/Population*100000,2))
usa_data <- usa_data %>% select(5,2,1,3,4,6)
data$state <-substr(data$State, 1, data$state_length -5)
df <- data %>% select(9,2,3,4,5,7)
usa_data <- usa_data %>% mutate(Rate = round(Death/Population*100000,2))
rm(list=ls())
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(as.character(data$Death))
data$Population <- as.numeric(as.character(data$Population))
data <- data %>% mutate(rate = round(Death/Population*100000,2))
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), State = "United States")
usa_data <- usa_data %>% mutate(Rate = round(Death/Population*100000,2))
usa_data <- usa_data %>% select(5,2,1,3,4,6)
data$States <-substr(data$State, 1, data$state_length -5)
state_one <- "Washington"
state_two <- "New York"
chosen_states <- df %>% filter(States == state_one| States == state_two)
chosen_states <- df %>% filter(States == state_one| States == state_two)
state_one <- "Washington"
state_two <- "New York"
chosen_states <- df %>% filter(States == state_one| States == state_two)
rm(list=ls())
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(as.character(data$Death))
data$Population <- as.numeric(as.character(data$Population))
data <- data %>% mutate(rate = round(Death/Population*100000,2))
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), State = "United States")
usa_data <- usa_data %>% mutate(Rate = round(Death/Population*100000,2))
usa_data <- usa_data %>% select(5,2,1,3,4,6)
data <- data %>% mutate(Rate = round(Death/Population*100000,2))
data$States <-substr(data$State, 1, data$state_length -5)
df <- data %>% select(9,2,3,4,5,7)
state_one <- "Washington"
state_two <- "New York"
chosen_states <- df %>% filter(States == state_one| States == state_two)
data$States <-substr(data$State, 1, data$state_length -5)
rm(list=ls())
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(as.character(data$Death))
data$Population <- as.numeric(as.character(data$Population))
data <- data %>% mutate(Rate = round(Death/Population*100000,2))
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), State = "United States")
usa_data <- usa_data %>% mutate(Rate = round(Death/Population*100000,2))
usa_data <- usa_data %>% select(5,2,1,3,4,6)
data$States <-substr(data$State, 1, data$state_length -5)
df <- data %>% select(9,2,3,4,5,7)
state_one <- "Washington"
state_two <- "New York"
chosen_states <- df %>% filter(States == state_one| States == state_two)
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), States = "United States")
combined_df <- rbind(df,usa_data)
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), States = "United States")
usa_data <- usa_data %>% mutate(Rate = round(Death/Population*100000,2))
usa_data <- usa_data %>% select(5,2,1,3,4,6)
combined_df <- rbind(df,usa_data)
chosen_states <- df %>% filter(States == state_one| States == state_two|States == "United States")
View(chosen_states)
chosen_states <- combined_df %>% filter(States == state_one| States == state_two|States == "United States")
chosen_states <- combined_df %>% filter(States == state_one| States == state_two|States == "United States")
combined_df <- rbind(df,usa_data)
combined_df <- rbind(df,usa_data)
View(combined_df)
combined_df <- rbind(df,usa_data)
View(combined)
View(combined_df)
colnames(usa_data)
colnames(df)
chosen_states <- df %>% filter(States == state_one| States == state_two| States == "United States")
chosen_gender <- chosen_states %>% filter(Gender == gender_choice)
gender_choice <- "Female"
chosen_gender <- chosen_states %>% filter(Gender == gender_choice)
combined_df <- rbind(df,usa_data)
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(as.character(data$Death))
data$Population <- as.numeric(as.character(data$Population))
data <- data %>% mutate(Rate = round(Death/Population*100000,2))
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), States = "United States")
usa_data <- usa_data %>% mutate(Rate = round(Death/Population*100000,2))
usa_data <- usa_data %>% select(5,2,1,3,4,6)
data$States <-substr(data$State, 1, data$state_length -5)
df <- data %>% select(9,2,3,4,5,7)
combined_df <- cbind(df,usa_data)
combined_df <- as.data.frame(cbind(df,usa_data))
View(combined_df)
combined_df <- as.data.frame(rbind(df,usa_data))
View(combined_df)
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(as.character(data$Death))
data$Population <- as.numeric(as.character(data$Population))
data <- data %>% mutate(Rate = round(Death/Population*100000,2))
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), States = "United States")
usa_data <- usa_data %>% mutate(Rate = round(Death/Population*100000,2))
usa_data <- usa_data %>% select(5,2,1,3,4,6)
data$States <-substr(data$State, 1, data$state_length -5)
df <- data %>% select(9,2,3,4,5,7)
combined_df <- rbind(usa_data, df)
View(combined_df)
combined_df <- bind_rows(usa_data, df)
View(combined_df)
chosen_states <- combined_df %>% filter(States == state_one| States == state_two| States == "United States")
chosen_states <- combined_df %>% filter(States == state_one| States == state_two| States == "United States")
chosen_gender <- chosen_states %>% filter(Gender == gender_choice)
View(chosen_gender)
p <- ggplot(data = chosen_gender) +
geom_line(mapping = aes(x= Year, y = Rate, group = States, color = States))+
geom_point(mapping = aes(x= Year, y = Rate, group = States, color = States))
p <- ggplot(data = chosen_gender) +
geom_line(mapping = aes(x= Year, y = Rate, group = States, color = States))+
geom_point(mapping = aes(x= Year, y = Rate, group = States, color = States))
chosen_gender <- chosen_states %>% filter(Gender == gender_choice)
p <- ggplot(data = chosen_gender) +
geom_line(mapping = aes(x= Year, y = Rate, group = States, color = States))+
geom_point(mapping = aes(x= Year, y = Rate, group = States, color = States))
p
combined_df <- bind_rows(chosen_gender,usa_data)
p <- ggplot(data = combined_df) +
geom_line(mapping = aes(x= Year, y = Rate, group = States, color = States))+
geom_point(mapping = aes(x= Year, y = Rate, group = States, color = States))
p
chosen_states <- combined_df %>% filter(States == state_one| States == state_two| States == "United States")
chosen_gender <- chosen_states %>% filter(Gender == gender_choice)
p <- ggplot(data = combined_df) +
geom_line(mapping = aes(x= Year, y = Rate, group = States, color = States))+
geom_point(mapping = aes(x= Year, y = Rate, group = States, color = States))
p
combined_df <- bind_rows(usa_data, df)
state_one <- "Washington"
state_two <- "New York"
gender_choice <- "Female"
chosen_states <- combined_df %>% filter(States == state_one| States == state_two| States == "United States")
p <- ggplot(data = chosen_gender) +
geom_line(mapping = aes(x= Year, y = Rate, group = States, color = States))+
geom_point(mapping = aes(x= Year, y = Rate, group = States, color = States))
p
overall_trend <- function(state_one, state_two, gender_choice){
chosen_states <- combined_df %>% filter(States == state_one| States == state_two| States == "United States")
chosen_gender <- chosen_states %>% filter(Gender == gender_choice)
p <- ggplot(data = chosen_gender) +
geom_line(mapping = aes(x= Year, y = Rate, group = States, color = States))+
geom_point(mapping = aes(x= Year, y = Rate, group = States, color = States))
p
}
overall_trend("California", "Washington", "Male")
overall_trend("New York", "Washington", "Male")
overall_trend("Minnesota", "Washington", "Male")
library(dplyr)
library(ggplot2)
library(tidyr)
data <- read.csv("data/intentional_self_harm_data.csv")
data$Death <- as.numeric(as.character(data$Death))
data$Population <- as.numeric(as.character(data$Population))
data <- data %>% mutate(Rate = round(Death/Population*100000,2))
as.character(data$State)
data$state_length <- nchar(as.character(data$State))
data$state_length <- as.numeric(data$state_length)
usa_data <- data %>% group_by(Year, Gender) %>% summarize(Death = sum(Death), Population = sum(Population), States = "United States")
usa_data <- usa_data %>% mutate(Rate = round(Death/Population*100000,2))
usa_data <- usa_data %>% select(5,2,1,3,4,6)
data$States <-substr(data$State, 1, data$state_length -5)
df <- data %>% select(9,2,3,4,5,7)
combined_df <- bind_rows(usa_data, df)
overall_trend <- function(state_one, state_two, gender_choice){
chosen_states <- combined_df %>% filter(States == state_one| States == state_two| States == "United States")
chosen_gender <- chosen_states %>% filter(Gender == gender_choice)
p <- ggplot(data = chosen_gender) +
geom_line(mapping = aes(x= Year, y = Rate, group = States, color = States))+
geom_point(mapping = aes(x= Year, y = Rate, group = States, color = States))
p
}
overall_trend("Minnesota", "Washington", "Male")
